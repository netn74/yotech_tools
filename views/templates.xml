<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <record id="view_yotech_tools_product_template_form" model="ir.ui.view">
            <field name="name">product.template.form.yotech.tools</field>
            <field name="model">product.template</field>
            <field name="priority">4</field>
            <field name="inherit_id" ref="product.product_template_form_view"/>
            <field name="arch" type="xml">
                <group name="sale" position="inside">
                    <group name="sale_add_message" string="Additional message">
                        <field name='website_price_displayed'>Price will be displayed on website?</field>
                        <field name='product_on_demand'>Product on demand?</field>
                        <field name="message_type_ids">Messages type list</field>
                    </group>
                </group>
           </field>
        </record>

        <!-- ACTIONS Yotech tools menu setting ACTIONS -->
        <record model="ir.actions.act_window" id="action_yotech_config" >
            <field name="name">Configure Yotech</field>
            <field name="res_model">yotech.settings</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record model="ir.actions.act_window" id="action_list_message_type_id">
            <field name="name">Message type</field>
            <field name="res_model">message.type</field>
            <field name="view_mode">tree,form</field>
        </record>

        <!-- MENUITEM Yotech Tools menu setting MENUITEM -->
        <menuitem name="Yotech Tools Settings"
            id="root_menu_base_yotech_tools"
            groups="base.group_sale_salesman,base.group_sale_manager" parent="base.menu_config" sequence="10" />

        <!-- <menuitem id="menu_yotech_tools_settings" name="Yotech Setting" parent="root_menu_base_yotech_tools" sequence="9"/> -->

        <menuitem id="menu_yotech_tools_settings" action="action_yotech_config" name="Yotech Config" parent="root_menu_base_yotech_tools" sequence = "1" />
        <menuitem id="menu_yotech_tools_set_messages_type" action="action_list_message_type_id" name="Message Type" parent="root_menu_base_yotech_tools" sequence = "1" />

        <!-- VIEWS Yotech Tools menu setting VIEWS  -->
        <record id="view_yotech_settings_tree" model="ir.ui.view">
            <field name="name">view.yotech.settings.tree</field>
            <field name="model">yotech.settings</field>
            <field name="priority">2</field>
            <field name="arch" type="xml">
                <tree string="Config List">
                    <field name="name" string="Config Name"/>
                </tree>
            </field>
        </record>

        <record id="view_yotech_settings_form" model="ir.ui.view">
            <field name="name">view.yotech.settings.form</field>
            <field name="model">yotech.settings</field>
            <field name="priority">4</field>
            <field name="arch" type="xml">
                <form string="Yotech Settings" class="oe_form_configuration">
                    <field name="name">Name</field>
                    <seperator/>
                    <group name="Behaviours">
                        <label for="id" string="Products"/>
                        <div>
                            <field name="product_out_of_stock_mgn" class="oe_inline"/>
                            <label for="product_out_of_stock_mgn"/>
                        </div>
                    </group>
                </form>
            </field>
        </record>

        <record id="yotech_view_cluster_tree" model="ir.ui.view">
            <field name="name">message.type.tree</field>
            <field name="model">message.type</field>
            <field name="priority">2</field>
            <field name="arch" type="xml">
                <tree string="Messages List">
                    <field name="name" string="Message name"/>
                </tree>
            </field>
        </record>

        <record id="yotech_view_tools_message_type_form" model="ir.ui.view">
            <field name="name">message.type.form.yotech.tools</field>
            <field name="model">message.type</field>
            <field name="priority">4</field>
            <field name="arch" type="xml">
                <form string="Sales Order">
                    <field name="name">Name</field>
                    <seperator/>
                    <field name="message">Message</field>
                </form>
            </field>
        </record>

        <!-- Website customisation -->
        <template id="yotech_custom_products_item" inherit_id="website_sale.products_item" name="Yotech Custom Product item">
            <xpath expr="//div[@class='product_price']" position="replace">
                <div itemprop="offers" itemscope="itemscope" itemtype="http://schema.org/Offer" class="product_price" t-if="product.product_variant_ids">
                    <t t-if="product.website_price_displayed">
                        <b>
                            <t t-if="(compute_currency(product.lst_price) - product.price) &gt; 0.1">
                                <del class="text-danger mr8" style="white-space: nowrap;" t-field="product.lst_price" t-field-options='{
                                    "widget": "monetary",
                                    "from_currency": "product.company_id.currency_id",
                                    "display_currency": "website.currency_id"
                                }'/>
                            </t>
                            <span t-field="product.price" style="white-space: nowrap;"  t-field-options='{
                                "widget": "monetary",
                                "display_currency": "website.currency_id"
                                }'>
                            </span>
                            <span itemprop="price" style="display:none;" t-esc="product.price"/>
                            <span itemprop="priceCurrency" style="display:none;" t-esc="website.currency_id.name"/>
                        </b>
                    </t>
              </div>
          </xpath>
        </template>

        <template id="yotech_custom_product_price" inherit_id="website_sale.product_price" name="Yotech Custom Product Price">
            <xpath expr="//div[@itemprop='offers']" position="replace">
                <div itemprop="offers" itemscope="itemscope" itemtype="http://schema.org/Offer" class="product_price mt16">
                    <t t-if="product.website_price_displayed">
                        <h4 class="oe_price_h4 css_editable_mode_hidden">
                            <span class="text-danger oe_default_price" style="text-decoration: line-through; white-space: nowrap;"
                              t-field="product.lst_price"
                              t-field-options='{
                                "widget": "monetary",
                                "from_currency": "product.company_id.currency_id",
                                "display_currency": "user_id.partner_id.property_product_pricelist.currency_id"
                             }'/>
                            <b class="oe_price" style="white-space: nowrap;"
                              t-field="product.price"
                              t-field-options='{
                                 "widget": "monetary",
                                 "display_currency": "user_id.partner_id.property_product_pricelist.currency_id"
                             }'/>
                            <span itemprop="price" style="display:none;" t-esc="product.price"/>
                            <span itemprop="priceCurrency" style="display:none;" t-esc="user_id.partner_id.property_product_pricelist.currency_id.name"/>
                        </h4>
                        <h4 class="css_editable_mode_display" style="display: none;">
                          <span t-field="product.lst_price"
                              t-field-options='{
                                 "widget": "monetary",
                                 "display_currency": "website.pricelist_id.currency_id"
                             }'/>
                        </h4>
                        <h4 class="hidden oe_not_available bg-warning">Product not available</h4>
                    </t>
                </div>
          </xpath>
        </template>
        <template id="yotech_custom_product" inherit_id="website_sale.product" name="Yotech Custom Product">
            <xpath expr="//div[@class='js_product']" position="replace">
                <div class="js_product">
                    <t t-placeholder="select">
                        <input type="hidden" class="product_id" name="product_id" t-att-value="int(product.product_variant_ids[0]) if len(product.product_variant_ids) == 1 else '0'"/>
                        <t t-call="website_sale.variants">
                            <t t-set="ul_class" t-value="'nav-stacked'"/>
                        </t>
                    </t>
                    <t t-if="product.website_price_displayed">
                        <t t-call="website_sale.product_price"/>
                        <p t-if="len(product.product_variant_ids) > 1" class="css_not_available_msg bg-danger" style="padding: 15px;">Product not available</p>

                        <a id="add_to_cart" class="btn btn-primary btn-lg mt8 js_check_product a-submit" href="#">Add to Cart</a>
                    </t>
                </div>
            </xpath>
        </template>
    </data>
</openerp>